<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>data bases</title>
    <meta charset="utf-8" />
    <meta name="author" content="Gina Reynolds, January 2020" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">







class: left, top, inverse
background-image: url(lightbulbs.jpg)
background-size: cover

# .large[relational databases]
### Walk-throughs with &lt;br&gt;{DBI}and {RSQLite}

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

#### .right[Gina Reynolds&lt;br&gt;Photo Credit: Fabio Bracht]


---



count: false
 
add tables
.panel1-dbi-user[

```r
*library(DBI)

# Create an ephemeral in-memory RSQLite database
*con &lt;- dbConnect(RSQLite::SQLite(),
*                dbname = ":memory:")
*dbListTables(con)
```
]
 
.panel2-dbi-user[

```
character(0)
```
]

---
count: false
 
add tables
.panel1-dbi-user[

```r
library(DBI)

# Create an ephemeral in-memory RSQLite database
con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")
dbListTables(con)

*dbWriteTable(con, "mtcars", mtcars)
*dbListTables(con)
```
]
 
.panel2-dbi-user[

```
character(0)
```

```
[1] "mtcars"
```
]

---
count: false
 
add tables
.panel1-dbi-user[

```r
library(DBI)

# Create an ephemeral in-memory RSQLite database
con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")
dbListTables(con)

dbWriteTable(con, "mtcars", mtcars)
dbListTables(con)

*library(gapminder)
*dbWriteTable(con, "gapminder", gapminder)
*dbListTables(con)
```
]
 
.panel2-dbi-user[

```
character(0)
```

```
[1] "mtcars"
```

```
[1] "gapminder" "mtcars"   
```
]

---
count: false
 
add tables
.panel1-dbi-user[

```r
library(DBI)

# Create an ephemeral in-memory RSQLite database
con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")
dbListTables(con)

dbWriteTable(con, "mtcars", mtcars)
dbListTables(con)

library(gapminder)
dbWriteTable(con, "gapminder", gapminder)
dbListTables(con)

*dbWriteTable(con, "my_country_tibble",
*            tibble::tibble(
*              country = c("Germany", "Chile"),
*              y = c(1,2)
*              ))
*dbListTables(con)
```
]
 
.panel2-dbi-user[

```
character(0)
```

```
[1] "mtcars"
```

```
[1] "gapminder" "mtcars"   
```

```
[1] "gapminder"         "mtcars"            "my_country_tibble"
```
]

&lt;style&gt;
.panel1-dbi-user {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-dbi-user {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-dbi-user {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---

count: false
 

.panel1-query-auto[

```r
*dbListFields(con, "mtcars")
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
*dbReadTable(con, "mtcars")
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```

```
    mpg cyl  disp  hp drat    wt  qsec vs am gear carb
1  21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
2  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
3  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
4  21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
5  18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
6  18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
7  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
8  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
9  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
10 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
11 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
12 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
13 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
14 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
15 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
16 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
17 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
18 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
19 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
20 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
21 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
22 15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
23 15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
24 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
25 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
26 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
27 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
28 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
29 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
30 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
31 15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
32 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
* my_table
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
*dbSendQuery(
* con,
* "SELECT * FROM mtcars WHERE cyl = 4")
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```

```
&lt;SQLiteResult&gt;
  SQL  SELECT * FROM mtcars WHERE cyl = 4
  ROWS Fetched: 0 [incomplete]
       Changed: 0
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
*query
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
query

*dbFetch(query)
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```

```
    mpg cyl  disp  hp drat    wt  qsec vs am gear carb
1  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
2  24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
3  22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
4  32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
5  30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
6  33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
7  21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
8  27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
9  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
10 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
11 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
query

dbFetch(query) -&gt;
* mtcars_subset
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
query

dbFetch(query) -&gt;
  mtcars_subset
*dbClearResult(query)
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
query

dbFetch(query) -&gt;
  mtcars_subset
dbClearResult(query)

# Or a chunk at a time
*dbSendQuery(
* con,
* "SELECT * FROM mtcars WHERE cyl = 4")
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```

```
&lt;SQLiteResult&gt;
  SQL  SELECT * FROM mtcars WHERE cyl = 4
  ROWS Fetched: 0 [incomplete]
       Changed: 0
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
query

dbFetch(query) -&gt;
  mtcars_subset
dbClearResult(query)

# Or a chunk at a time
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
*res
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
query

dbFetch(query) -&gt;
  mtcars_subset
dbClearResult(query)

# Or a chunk at a time
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
res

# I dont really understand this part
*while(!dbHasCompleted(res)){
* chunk &lt;- dbFetch(res, n = 5)
* print(nrow(chunk))
*} 
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```

```
[1] 5
[1] 5
[1] 1
```
]

---
count: false
 

.panel1-query-auto[

```r
dbListFields(con, "mtcars")
dbReadTable(con, "mtcars") -&gt;
  my_table

# You can fetch all results:
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
query

dbFetch(query) -&gt;
  mtcars_subset
dbClearResult(query)

# Or a chunk at a time
dbSendQuery(
  con,
  "SELECT * FROM mtcars WHERE cyl = 4") -&gt;
res

# I dont really understand this part
while(!dbHasCompleted(res)){
  chunk &lt;- dbFetch(res, n = 5)
  print(nrow(chunk))
}

*dbClearResult(res)
```
]
 
.panel2-query-auto[

```
 [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"
```

```
[1] 5
[1] 5
[1] 1
```
]

&lt;style&gt;
.panel1-query-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-query-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-query-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---

# Real relational data

--

### unvotes is a package that contains three related data frames. 

--

&gt; This package provides the voting history of countries in the United Nations General Assembly, along with information such as date, description, and topics for each vote.

--

### let's see if we can't get these into a database.

---

count: false
 
Three data frames
.panel1-unvotes-rotate[

```r
library(unvotes)
*un_roll_call_issues
```
]
 
.panel2-unvotes-rotate[

```
# A tibble: 5,281 x 3
    rcid short_name issue               
   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;               
 1  3372 me         Palestinian conflict
 2  3658 me         Palestinian conflict
 3  3692 me         Palestinian conflict
 4  2901 me         Palestinian conflict
 5  3020 me         Palestinian conflict
 6  3217 me         Palestinian conflict
 7  3298 me         Palestinian conflict
 8  3429 me         Palestinian conflict
 9  3558 me         Palestinian conflict
10  3625 me         Palestinian conflict
# … with 5,271 more rows
```
]

---
count: false
 
Three data frames
.panel1-unvotes-rotate[

```r
library(unvotes)
*un_roll_calls
```
]
 
.panel2-unvotes-rotate[

```
# A tibble: 5,429 x 9
    rcid session importantvote date       unres  amend  para short   descr      
   &lt;int&gt;   &lt;dbl&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      
 1     3       1             0 1946-01-01 R/1/66     1     0 AMENDM… "TO ADOPT …
 2     4       1             0 1946-01-02 R/1/79     0     0 SECURI… "TO ADOPT …
 3     5       1             0 1946-01-04 R/1/98     0     0 VOTING… "TO ADOPT …
 4     6       1             0 1946-01-04 R/1/1…     0     0 DECLAR… "TO ADOPT …
 5     7       1             0 1946-01-02 R/1/2…     1     0 GENERA… "TO ADOPT …
 6     8       1             0 1946-01-05 R/1/2…     1     0 ECOSOC… "TO ADOPT …
 7     9       1             0 1946-02-05 R/1/3…     0     0 POST-W… "TO OPEN T…
 8    10       1             0 1946-02-05 R/1/3…     1     1 U.N. M… "TO ADOPT …
 9    11       1             0 1946-02-05 R/1/3…     0     0 TRUSTE… "TO ADOPT …
10    12       1             0 1946-02-06 R/1/3…     1     1 COUNCI… "TO ADOPT …
# … with 5,419 more rows
```
]

---
count: false
 
Three data frames
.panel1-unvotes-rotate[

```r
library(unvotes)
*un_votes
```
]
 
.panel2-unvotes-rotate[

```
# A tibble: 738,764 x 4
    rcid country                  country_code vote 
   &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;        &lt;fct&gt;
 1     3 United States of America US           yes  
 2     3 Canada                   CA           no   
 3     3 Cuba                     CU           yes  
 4     3 Haiti                    HT           yes  
 5     3 Dominican Republic       DO           yes  
 6     3 Mexico                   MX           yes  
 7     3 Guatemala                GT           yes  
 8     3 Honduras                 HN           yes  
 9     3 El Salvador              SV           yes  
10     3 Nicaragua                NI           yes  
# … with 738,754 more rows
```
]

&lt;style&gt;
.panel1-unvotes-rotate {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-unvotes-rotate {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-unvotes-rotate {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---

# Cleaning and building dictionaries, meta data

---

count: false
 

.panel1-issues-auto[

```r
*unvotes::un_roll_call_issues
```
]
 
.panel2-issues-auto[

```
# A tibble: 5,281 x 3
    rcid short_name issue               
   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;               
 1  3372 me         Palestinian conflict
 2  3658 me         Palestinian conflict
 3  3692 me         Palestinian conflict
 4  2901 me         Palestinian conflict
 5  3020 me         Palestinian conflict
 6  3217 me         Palestinian conflict
 7  3298 me         Palestinian conflict
 8  3429 me         Palestinian conflict
 9  3558 me         Palestinian conflict
10  3625 me         Palestinian conflict
# … with 5,271 more rows
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
* select(-issue)
```
]
 
.panel2-issues-auto[

```
# A tibble: 5,281 x 2
    rcid short_name
   &lt;int&gt; &lt;chr&gt;     
 1  3372 me        
 2  3658 me        
 3  3692 me        
 4  2901 me        
 5  3020 me        
 6  3217 me        
 7  3298 me        
 8  3429 me        
 9  3558 me        
10  3625 me        
# … with 5,271 more rows
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
* mutate(is_true = 1)
```
]
 
.panel2-issues-auto[

```
# A tibble: 5,281 x 3
    rcid short_name is_true
   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
 1  3372 me               1
 2  3658 me               1
 3  3692 me               1
 4  2901 me               1
 5  3020 me               1
 6  3217 me               1
 7  3298 me               1
 8  3429 me               1
 9  3558 me               1
10  3625 me               1
# … with 5,271 more rows
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
* mutate(short_name = paste0("ind_issue_",
*                            short_name))
```
]
 
.panel2-issues-auto[

```
# A tibble: 5,281 x 3
    rcid short_name   is_true
   &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
 1  3372 ind_issue_me       1
 2  3658 ind_issue_me       1
 3  3692 ind_issue_me       1
 4  2901 ind_issue_me       1
 5  3020 ind_issue_me       1
 6  3217 ind_issue_me       1
 7  3298 ind_issue_me       1
 8  3429 ind_issue_me       1
 9  3558 ind_issue_me       1
10  3625 ind_issue_me       1
# … with 5,271 more rows
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
* pivot_wider(names_from = short_name,
*             values_from = is_true)
```
]
 
.panel2-issues-auto[

```
# A tibble: 3,927 x 7
    rcid ind_issue_me ind_issue_nu ind_issue_di ind_issue_hr ind_issue_co
   &lt;int&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1  3372            1           NA           NA           NA           NA
 2  3658            1           NA           NA           NA           NA
 3  3692            1           NA           NA           NA            1
 4  2901            1           NA           NA           NA           NA
 5  3020            1           NA           NA           NA           NA
 6  3217            1           NA           NA           NA           NA
 7  3298            1           NA           NA           NA           NA
 8  3429            1           NA           NA           NA           NA
 9  3558            1           NA           NA           NA           NA
10  3625            1           NA           NA           NA           NA
# … with 3,917 more rows, and 1 more variable: ind_issue_ec &lt;dbl&gt;
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
* mutate_all(~replace(., is.na(.), 0))
```
]
 
.panel2-issues-auto[

```
# A tibble: 3,927 x 7
    rcid ind_issue_me ind_issue_nu ind_issue_di ind_issue_hr ind_issue_co
   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1  3372            1            0            0            0            0
 2  3658            1            0            0            0            0
 3  3692            1            0            0            0            1
 4  2901            1            0            0            0            0
 5  3020            1            0            0            0            0
 6  3217            1            0            0            0            0
 7  3298            1            0            0            0            0
 8  3429            1            0            0            0            0
 9  3558            1            0            0            0            0
10  3625            1            0            0            0            0
# … with 3,917 more rows, and 1 more variable: ind_issue_ec &lt;dbl&gt;
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
* rename(id_rollcall = rcid)
```
]
 
.panel2-issues-auto[

```
# A tibble: 3,927 x 7
   id_rollcall ind_issue_me ind_issue_nu ind_issue_di ind_issue_hr ind_issue_co
         &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1        3372            1            0            0            0            0
 2        3658            1            0            0            0            0
 3        3692            1            0            0            0            1
 4        2901            1            0            0            0            0
 5        3020            1            0            0            0            0
 6        3217            1            0            0            0            0
 7        3298            1            0            0            0            0
 8        3429            1            0            0            0            0
 9        3558            1            0            0            0            0
10        3625            1            0            0            0            0
# … with 3,917 more rows, and 1 more variable: ind_issue_ec &lt;dbl&gt;
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
  rename(id_rollcall = rcid) -&gt;
*rcid_issue_indicator_columns
```
]
 
.panel2-issues-auto[

]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
  rename(id_rollcall = rcid) -&gt;
rcid_issue_indicator_columns

*unvotes::un_roll_call_issues
```
]
 
.panel2-issues-auto[

```
# A tibble: 5,281 x 3
    rcid short_name issue               
   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;               
 1  3372 me         Palestinian conflict
 2  3658 me         Palestinian conflict
 3  3692 me         Palestinian conflict
 4  2901 me         Palestinian conflict
 5  3020 me         Palestinian conflict
 6  3217 me         Palestinian conflict
 7  3298 me         Palestinian conflict
 8  3429 me         Palestinian conflict
 9  3558 me         Palestinian conflict
10  3625 me         Palestinian conflict
# … with 5,271 more rows
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
  rename(id_rollcall = rcid) -&gt;
rcid_issue_indicator_columns

unvotes::un_roll_call_issues %&gt;%
* distinct(issue, short_name)
```
]
 
.panel2-issues-auto[

```
# A tibble: 6 x 2
  short_name issue                               
  &lt;chr&gt;      &lt;chr&gt;                               
1 me         Palestinian conflict                
2 nu         Nuclear weapons and nuclear material
3 di         Arms control and disarmament        
4 hr         Human rights                        
5 co         Colonialism                         
6 ec         Economic development                
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
  rename(id_rollcall = rcid) -&gt;
rcid_issue_indicator_columns

unvotes::un_roll_call_issues %&gt;%
  distinct(issue, short_name) %&gt;%
* mutate(short_name = paste0("ind_issue_",
*                            short_name))
```
]
 
.panel2-issues-auto[

```
# A tibble: 6 x 2
  short_name   issue                               
  &lt;chr&gt;        &lt;chr&gt;                               
1 ind_issue_me Palestinian conflict                
2 ind_issue_nu Nuclear weapons and nuclear material
3 ind_issue_di Arms control and disarmament        
4 ind_issue_hr Human rights                        
5 ind_issue_co Colonialism                         
6 ind_issue_ec Economic development                
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
  rename(id_rollcall = rcid) -&gt;
rcid_issue_indicator_columns

unvotes::un_roll_call_issues %&gt;%
  distinct(issue, short_name) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
* rename(col_name = short_name)
```
]
 
.panel2-issues-auto[

```
# A tibble: 6 x 2
  col_name     issue                               
  &lt;chr&gt;        &lt;chr&gt;                               
1 ind_issue_me Palestinian conflict                
2 ind_issue_nu Nuclear weapons and nuclear material
3 ind_issue_di Arms control and disarmament        
4 ind_issue_hr Human rights                        
5 ind_issue_co Colonialism                         
6 ind_issue_ec Economic development                
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
  rename(id_rollcall = rcid) -&gt;
rcid_issue_indicator_columns

unvotes::un_roll_call_issues %&gt;%
  distinct(issue, short_name) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  rename(col_name = short_name) %&gt;%
* rename(definition = issue)
```
]
 
.panel2-issues-auto[

```
# A tibble: 6 x 2
  col_name     definition                          
  &lt;chr&gt;        &lt;chr&gt;                               
1 ind_issue_me Palestinian conflict                
2 ind_issue_nu Nuclear weapons and nuclear material
3 ind_issue_di Arms control and disarmament        
4 ind_issue_hr Human rights                        
5 ind_issue_co Colonialism                         
6 ind_issue_ec Economic development                
```
]

---
count: false
 

.panel1-issues-auto[

```r
unvotes::un_roll_call_issues %&gt;%
  select(-issue) %&gt;%
  mutate(is_true = 1) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  pivot_wider(names_from = short_name,
              values_from = is_true) %&gt;%
  mutate_all(~replace(., is.na(.), 0)) %&gt;%
  rename(id_rollcall = rcid) -&gt;
rcid_issue_indicator_columns

unvotes::un_roll_call_issues %&gt;%
  distinct(issue, short_name) %&gt;%
  mutate(short_name = paste0("ind_issue_",
                             short_name)) %&gt;%
  rename(col_name = short_name) %&gt;%
  rename(definition = issue) -&gt;
*col_definitions_roll_call_issues
```
]
 
.panel2-issues-auto[

]

&lt;style&gt;
.panel1-issues-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-issues-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-issues-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---

count: false
 

.panel1-votes-auto[

```r
*unvotes::un_votes
```
]
 
.panel2-votes-auto[

```
# A tibble: 738,764 x 4
    rcid country                  country_code vote 
   &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;        &lt;fct&gt;
 1     3 United States of America US           yes  
 2     3 Canada                   CA           no   
 3     3 Cuba                     CU           yes  
 4     3 Haiti                    HT           yes  
 5     3 Dominican Republic       DO           yes  
 6     3 Mexico                   MX           yes  
 7     3 Guatemala                GT           yes  
 8     3 Honduras                 HN           yes  
 9     3 El Salvador              SV           yes  
10     3 Nicaragua                NI           yes  
# … with 738,754 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
* distinct(country, country_code)
```
]
 
.panel2-votes-auto[

```
# A tibble: 200 x 2
   country                  country_code
   &lt;chr&gt;                    &lt;chr&gt;       
 1 United States of America US          
 2 Canada                   CA          
 3 Cuba                     CU          
 4 Haiti                    HT          
 5 Dominican Republic       DO          
 6 Mexico                   MX          
 7 Guatemala                GT          
 8 Honduras                 HN          
 9 El Salvador              SV          
10 Nicaragua                NI          
# … with 190 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
* rename(id_country_code = country_code)
```
]
 
.panel2-votes-auto[

```
# A tibble: 200 x 2
   country                  id_country_code
   &lt;chr&gt;                    &lt;chr&gt;          
 1 United States of America US             
 2 Canada                   CA             
 3 Cuba                     CU             
 4 Haiti                    HT             
 5 Dominican Republic       DO             
 6 Mexico                   MX             
 7 Guatemala                GT             
 8 Honduras                 HN             
 9 El Salvador              SV             
10 Nicaragua                NI             
# … with 190 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
* select(id_country_code, country)
```
]
 
.panel2-votes-auto[

```
# A tibble: 200 x 2
   id_country_code country                 
   &lt;chr&gt;           &lt;chr&gt;                   
 1 US              United States of America
 2 CA              Canada                  
 3 CU              Cuba                    
 4 HT              Haiti                   
 5 DO              Dominican Republic      
 6 MX              Mexico                  
 7 GT              Guatemala               
 8 HN              Honduras                
 9 SV              El Salvador             
10 NI              Nicaragua               
# … with 190 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
* arrange(id_country_code)
```
]
 
.panel2-votes-auto[

```
# A tibble: 200 x 2
   id_country_code country             
   &lt;chr&gt;           &lt;chr&gt;               
 1 AD              Andorra             
 2 AE              United Arab Emirates
 3 AF              Afghanistan         
 4 AG              Antigua and Barbuda 
 5 AL              Albania             
 6 AM              Armenia             
 7 AO              Angola              
 8 AR              Argentina           
 9 AT              Austria             
10 AU              Australia           
# … with 190 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
  arrange(id_country_code) -&gt;
*dict_country
```
]
 
.panel2-votes-auto[

]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
  arrange(id_country_code) -&gt;
dict_country

*unvotes::un_votes
```
]
 
.panel2-votes-auto[

```
# A tibble: 738,764 x 4
    rcid country                  country_code vote 
   &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;        &lt;fct&gt;
 1     3 United States of America US           yes  
 2     3 Canada                   CA           no   
 3     3 Cuba                     CU           yes  
 4     3 Haiti                    HT           yes  
 5     3 Dominican Republic       DO           yes  
 6     3 Mexico                   MX           yes  
 7     3 Guatemala                GT           yes  
 8     3 Honduras                 HN           yes  
 9     3 El Salvador              SV           yes  
10     3 Nicaragua                NI           yes  
# … with 738,754 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
  arrange(id_country_code) -&gt;
dict_country

unvotes::un_votes %&gt;%
* rename(id_rollcall = rcid)
```
]
 
.panel2-votes-auto[

```
# A tibble: 738,764 x 4
   id_rollcall country                  country_code vote 
         &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;        &lt;fct&gt;
 1           3 United States of America US           yes  
 2           3 Canada                   CA           no   
 3           3 Cuba                     CU           yes  
 4           3 Haiti                    HT           yes  
 5           3 Dominican Republic       DO           yes  
 6           3 Mexico                   MX           yes  
 7           3 Guatemala                GT           yes  
 8           3 Honduras                 HN           yes  
 9           3 El Salvador              SV           yes  
10           3 Nicaragua                NI           yes  
# … with 738,754 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
  arrange(id_country_code) -&gt;
dict_country

unvotes::un_votes %&gt;%
  rename(id_rollcall = rcid) %&gt;%
* rename(id_country_cow = country_code)
```
]
 
.panel2-votes-auto[

```
# A tibble: 738,764 x 4
   id_rollcall country                  id_country_cow vote 
         &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;          &lt;fct&gt;
 1           3 United States of America US             yes  
 2           3 Canada                   CA             no   
 3           3 Cuba                     CU             yes  
 4           3 Haiti                    HT             yes  
 5           3 Dominican Republic       DO             yes  
 6           3 Mexico                   MX             yes  
 7           3 Guatemala                GT             yes  
 8           3 Honduras                 HN             yes  
 9           3 El Salvador              SV             yes  
10           3 Nicaragua                NI             yes  
# … with 738,754 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
  arrange(id_country_code) -&gt;
dict_country

unvotes::un_votes %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(id_country_cow = country_code) %&gt;%
* rename(cat_vote = vote)
```
]
 
.panel2-votes-auto[

```
# A tibble: 738,764 x 4
   id_rollcall country                  id_country_cow cat_vote
         &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;          &lt;fct&gt;   
 1           3 United States of America US             yes     
 2           3 Canada                   CA             no      
 3           3 Cuba                     CU             yes     
 4           3 Haiti                    HT             yes     
 5           3 Dominican Republic       DO             yes     
 6           3 Mexico                   MX             yes     
 7           3 Guatemala                GT             yes     
 8           3 Honduras                 HN             yes     
 9           3 El Salvador              SV             yes     
10           3 Nicaragua                NI             yes     
# … with 738,754 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
  arrange(id_country_code) -&gt;
dict_country

unvotes::un_votes %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(id_country_cow = country_code) %&gt;%
  rename(cat_vote = vote) %&gt;%
* select(-country)
```
]
 
.panel2-votes-auto[

```
# A tibble: 738,764 x 3
   id_rollcall id_country_cow cat_vote
         &lt;int&gt; &lt;chr&gt;          &lt;fct&gt;   
 1           3 US             yes     
 2           3 CA             no      
 3           3 CU             yes     
 4           3 HT             yes     
 5           3 DO             yes     
 6           3 MX             yes     
 7           3 GT             yes     
 8           3 HN             yes     
 9           3 SV             yes     
10           3 NI             yes     
# … with 738,754 more rows
```
]

---
count: false
 

.panel1-votes-auto[

```r
unvotes::un_votes %&gt;%
  distinct(country, country_code) %&gt;%
  rename(id_country_code = country_code) %&gt;%
  select(id_country_code, country) %&gt;%
  arrange(id_country_code) -&gt;
dict_country

unvotes::un_votes %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(id_country_cow = country_code) %&gt;%
  rename(cat_vote = vote) %&gt;%
  select(-country) -&gt;
*tbl_un_votes
```
]
 
.panel2-votes-auto[

]

&lt;style&gt;
.panel1-votes-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-votes-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-votes-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---

count: false
 

.panel1-rollcalls-auto[

```r
*unvotes::un_roll_calls
```
]
 
.panel2-rollcalls-auto[

```
# A tibble: 5,429 x 9
    rcid session importantvote date       unres  amend  para short   descr      
   &lt;int&gt;   &lt;dbl&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      
 1     3       1             0 1946-01-01 R/1/66     1     0 AMENDM… "TO ADOPT …
 2     4       1             0 1946-01-02 R/1/79     0     0 SECURI… "TO ADOPT …
 3     5       1             0 1946-01-04 R/1/98     0     0 VOTING… "TO ADOPT …
 4     6       1             0 1946-01-04 R/1/1…     0     0 DECLAR… "TO ADOPT …
 5     7       1             0 1946-01-02 R/1/2…     1     0 GENERA… "TO ADOPT …
 6     8       1             0 1946-01-05 R/1/2…     1     0 ECOSOC… "TO ADOPT …
 7     9       1             0 1946-02-05 R/1/3…     0     0 POST-W… "TO OPEN T…
 8    10       1             0 1946-02-05 R/1/3…     1     1 U.N. M… "TO ADOPT …
 9    11       1             0 1946-02-05 R/1/3…     0     0 TRUSTE… "TO ADOPT …
10    12       1             0 1946-02-06 R/1/3…     1     1 COUNCI… "TO ADOPT …
# … with 5,419 more rows
```
]

---
count: false
 

.panel1-rollcalls-auto[

```r
unvotes::un_roll_calls %&gt;%
* rename(id_rollcall = rcid)
```
]
 
.panel2-rollcalls-auto[

```
# A tibble: 5,429 x 9
   id_rollcall session importantvote date       unres  amend  para short descr  
         &lt;int&gt;   &lt;dbl&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
 1           3       1             0 1946-01-01 R/1/66     1     0 AMEN… "TO AD…
 2           4       1             0 1946-01-02 R/1/79     0     0 SECU… "TO AD…
 3           5       1             0 1946-01-04 R/1/98     0     0 VOTI… "TO AD…
 4           6       1             0 1946-01-04 R/1/1…     0     0 DECL… "TO AD…
 5           7       1             0 1946-01-02 R/1/2…     1     0 GENE… "TO AD…
 6           8       1             0 1946-01-05 R/1/2…     1     0 ECOS… "TO AD…
 7           9       1             0 1946-02-05 R/1/3…     0     0 POST… "TO OP…
 8          10       1             0 1946-02-05 R/1/3…     1     1 U.N.… "TO AD…
 9          11       1             0 1946-02-05 R/1/3…     0     0 TRUS… "TO AD…
10          12       1             0 1946-02-06 R/1/3…     1     1 COUN… "TO AD…
# … with 5,419 more rows
```
]

---
count: false
 

.panel1-rollcalls-auto[

```r
unvotes::un_roll_calls %&gt;%
  rename(id_rollcall = rcid) %&gt;%
* rename(dt_vote = date)
```
]
 
.panel2-rollcalls-auto[

```
# A tibble: 5,429 x 9
   id_rollcall session importantvote dt_vote    unres  amend  para short descr  
         &lt;int&gt;   &lt;dbl&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
 1           3       1             0 1946-01-01 R/1/66     1     0 AMEN… "TO AD…
 2           4       1             0 1946-01-02 R/1/79     0     0 SECU… "TO AD…
 3           5       1             0 1946-01-04 R/1/98     0     0 VOTI… "TO AD…
 4           6       1             0 1946-01-04 R/1/1…     0     0 DECL… "TO AD…
 5           7       1             0 1946-01-02 R/1/2…     1     0 GENE… "TO AD…
 6           8       1             0 1946-01-05 R/1/2…     1     0 ECOS… "TO AD…
 7           9       1             0 1946-02-05 R/1/3…     0     0 POST… "TO OP…
 8          10       1             0 1946-02-05 R/1/3…     1     1 U.N.… "TO AD…
 9          11       1             0 1946-02-05 R/1/3…     0     0 TRUS… "TO AD…
10          12       1             0 1946-02-06 R/1/3…     1     1 COUN… "TO AD…
# … with 5,419 more rows
```
]

---
count: false
 

.panel1-rollcalls-auto[

```r
unvotes::un_roll_calls %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(dt_vote = date) %&gt;%
* rename(ind_importantvote = importantvote)
```
]
 
.panel2-rollcalls-auto[

```
# A tibble: 5,429 x 9
   id_rollcall session ind_importantvo… dt_vote    unres amend  para short descr
         &lt;int&gt;   &lt;dbl&gt;            &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
 1           3       1                0 1946-01-01 R/1/…     1     0 AMEN… "TO …
 2           4       1                0 1946-01-02 R/1/…     0     0 SECU… "TO …
 3           5       1                0 1946-01-04 R/1/…     0     0 VOTI… "TO …
 4           6       1                0 1946-01-04 R/1/…     0     0 DECL… "TO …
 5           7       1                0 1946-01-02 R/1/…     1     0 GENE… "TO …
 6           8       1                0 1946-01-05 R/1/…     1     0 ECOS… "TO …
 7           9       1                0 1946-02-05 R/1/…     0     0 POST… "TO …
 8          10       1                0 1946-02-05 R/1/…     1     1 U.N.… "TO …
 9          11       1                0 1946-02-05 R/1/…     0     0 TRUS… "TO …
10          12       1                0 1946-02-06 R/1/…     1     1 COUN… "TO …
# … with 5,419 more rows
```
]

---
count: false
 

.panel1-rollcalls-auto[

```r
unvotes::un_roll_calls %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(dt_vote = date) %&gt;%
  rename(ind_importantvote = importantvote) %&gt;%
* rename(ind_amendment = amend)
```
]
 
.panel2-rollcalls-auto[

```
# A tibble: 5,429 x 9
   id_rollcall session ind_importantvo… dt_vote    unres ind_amendment  para
         &lt;int&gt;   &lt;dbl&gt;            &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
 1           3       1                0 1946-01-01 R/1/…             1     0
 2           4       1                0 1946-01-02 R/1/…             0     0
 3           5       1                0 1946-01-04 R/1/…             0     0
 4           6       1                0 1946-01-04 R/1/…             0     0
 5           7       1                0 1946-01-02 R/1/…             1     0
 6           8       1                0 1946-01-05 R/1/…             1     0
 7           9       1                0 1946-02-05 R/1/…             0     0
 8          10       1                0 1946-02-05 R/1/…             1     1
 9          11       1                0 1946-02-05 R/1/…             0     0
10          12       1                0 1946-02-06 R/1/…             1     1
# … with 5,419 more rows, and 2 more variables: short &lt;chr&gt;, descr &lt;chr&gt;
```
]

---
count: false
 

.panel1-rollcalls-auto[

```r
unvotes::un_roll_calls %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(dt_vote = date) %&gt;%
  rename(ind_importantvote = importantvote) %&gt;%
  rename(ind_amendment = amend) %&gt;%
* rename(ind_paragraph_vote = para)
```
]
 
.panel2-rollcalls-auto[

```
# A tibble: 5,429 x 9
   id_rollcall session ind_importantvo… dt_vote    unres ind_amendment
         &lt;int&gt;   &lt;dbl&gt;            &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt;
 1           3       1                0 1946-01-01 R/1/…             1
 2           4       1                0 1946-01-02 R/1/…             0
 3           5       1                0 1946-01-04 R/1/…             0
 4           6       1                0 1946-01-04 R/1/…             0
 5           7       1                0 1946-01-02 R/1/…             1
 6           8       1                0 1946-01-05 R/1/…             1
 7           9       1                0 1946-02-05 R/1/…             0
 8          10       1                0 1946-02-05 R/1/…             1
 9          11       1                0 1946-02-05 R/1/…             0
10          12       1                0 1946-02-06 R/1/…             1
# … with 5,419 more rows, and 3 more variables: ind_paragraph_vote &lt;dbl&gt;,
#   short &lt;chr&gt;, descr &lt;chr&gt;
```
]

---
count: false
 

.panel1-rollcalls-auto[

```r
unvotes::un_roll_calls %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(dt_vote = date) %&gt;%
  rename(ind_importantvote = importantvote) %&gt;%
  rename(ind_amendment = amend) %&gt;%
  rename(ind_paragraph_vote = para) %&gt;%
* full_join(rcid_issue_indicator_columns)
```
]
 
.panel2-rollcalls-auto[

```
# A tibble: 5,429 x 15
   id_rollcall session ind_importantvo… dt_vote    unres ind_amendment
         &lt;dbl&gt;   &lt;dbl&gt;            &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt;
 1           3       1                0 1946-01-01 R/1/…             1
 2           4       1                0 1946-01-02 R/1/…             0
 3           5       1                0 1946-01-04 R/1/…             0
 4           6       1                0 1946-01-04 R/1/…             0
 5           7       1                0 1946-01-02 R/1/…             1
 6           8       1                0 1946-01-05 R/1/…             1
 7           9       1                0 1946-02-05 R/1/…             0
 8          10       1                0 1946-02-05 R/1/…             1
 9          11       1                0 1946-02-05 R/1/…             0
10          12       1                0 1946-02-06 R/1/…             1
# … with 5,419 more rows, and 9 more variables: ind_paragraph_vote &lt;dbl&gt;,
#   short &lt;chr&gt;, descr &lt;chr&gt;, ind_issue_me &lt;dbl&gt;, ind_issue_nu &lt;dbl&gt;,
#   ind_issue_di &lt;dbl&gt;, ind_issue_hr &lt;dbl&gt;, ind_issue_co &lt;dbl&gt;,
#   ind_issue_ec &lt;dbl&gt;
```
]

---
count: false
 

.panel1-rollcalls-auto[

```r
unvotes::un_roll_calls %&gt;%
  rename(id_rollcall = rcid) %&gt;%
  rename(dt_vote = date) %&gt;%
  rename(ind_importantvote = importantvote) %&gt;%
  rename(ind_amendment = amend) %&gt;%
  rename(ind_paragraph_vote = para) %&gt;%
  full_join(rcid_issue_indicator_columns) -&gt;
*tbl_un_roll_calls
```
]
 
.panel2-rollcalls-auto[

]

&lt;style&gt;
.panel1-rollcalls-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-rollcalls-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-rollcalls-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---

# Long form for variable name descriptions

---

count: false
 

.panel1-define_vars-auto[

```r
*list(tbl_un_roll_calls,
*    tbl_un_votes,
*    dict_country)
```
]
 
.panel2-define_vars-auto[

```
[[1]]
# A tibble: 5,429 x 15
   id_rollcall session ind_importantvo… dt_vote    unres ind_amendment
         &lt;dbl&gt;   &lt;dbl&gt;            &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt;
 1           3       1                0 1946-01-01 R/1/…             1
 2           4       1                0 1946-01-02 R/1/…             0
 3           5       1                0 1946-01-04 R/1/…             0
 4           6       1                0 1946-01-04 R/1/…             0
 5           7       1                0 1946-01-02 R/1/…             1
 6           8       1                0 1946-01-05 R/1/…             1
 7           9       1                0 1946-02-05 R/1/…             0
 8          10       1                0 1946-02-05 R/1/…             1
 9          11       1                0 1946-02-05 R/1/…             0
10          12       1                0 1946-02-06 R/1/…             1
# … with 5,419 more rows, and 9 more variables: ind_paragraph_vote &lt;dbl&gt;,
#   short &lt;chr&gt;, descr &lt;chr&gt;, ind_issue_me &lt;dbl&gt;, ind_issue_nu &lt;dbl&gt;,
#   ind_issue_di &lt;dbl&gt;, ind_issue_hr &lt;dbl&gt;, ind_issue_co &lt;dbl&gt;,
#   ind_issue_ec &lt;dbl&gt;

[[2]]
# A tibble: 738,764 x 3
   id_rollcall id_country_cow cat_vote
         &lt;int&gt; &lt;chr&gt;          &lt;fct&gt;   
 1           3 US             yes     
 2           3 CA             no      
 3           3 CU             yes     
 4           3 HT             yes     
 5           3 DO             yes     
 6           3 MX             yes     
 7           3 GT             yes     
 8           3 HN             yes     
 9           3 SV             yes     
10           3 NI             yes     
# … with 738,754 more rows

[[3]]
# A tibble: 200 x 2
   id_country_code country             
   &lt;chr&gt;           &lt;chr&gt;               
 1 AD              Andorra             
 2 AE              United Arab Emirates
 3 AF              Afghanistan         
 4 AG              Antigua and Barbuda 
 5 AL              Albania             
 6 AM              Armenia             
 7 AO              Angola              
 8 AR              Argentina           
 9 AT              Austria             
10 AU              Australia           
# … with 190 more rows
```
]

---
count: false
 

.panel1-define_vars-auto[

```r
list(tbl_un_roll_calls,
     tbl_un_votes,
     dict_country) %&gt;%
* tibble(tables = .)
```
]
 
.panel2-define_vars-auto[

```
# A tibble: 3 x 1
  tables                
  &lt;list&gt;                
1 &lt;tibble [5,429 × 15]&gt; 
2 &lt;tibble [738,764 × 3]&gt;
3 &lt;tibble [200 × 2]&gt;    
```
]

---
count: false
 

.panel1-define_vars-auto[

```r
list(tbl_un_roll_calls,
     tbl_un_votes,
     dict_country) %&gt;%
  tibble(tables = .) %&gt;%
* mutate(col_name = map(tables, names))
```
]
 
.panel2-define_vars-auto[

```
# A tibble: 3 x 2
  tables                 col_name  
  &lt;list&gt;                 &lt;list&gt;    
1 &lt;tibble [5,429 × 15]&gt;  &lt;chr [15]&gt;
2 &lt;tibble [738,764 × 3]&gt; &lt;chr [3]&gt; 
3 &lt;tibble [200 × 2]&gt;     &lt;chr [2]&gt; 
```
]

---
count: false
 

.panel1-define_vars-auto[

```r
list(tbl_un_roll_calls,
     tbl_un_votes,
     dict_country) %&gt;%
  tibble(tables = .) %&gt;%
  mutate(col_name = map(tables, names)) %&gt;%
* select(-tables)
```
]
 
.panel2-define_vars-auto[

```
# A tibble: 3 x 1
  col_name  
  &lt;list&gt;    
1 &lt;chr [15]&gt;
2 &lt;chr [3]&gt; 
3 &lt;chr [2]&gt; 
```
]

---
count: false
 

.panel1-define_vars-auto[

```r
list(tbl_un_roll_calls,
     tbl_un_votes,
     dict_country) %&gt;%
  tibble(tables = .) %&gt;%
  mutate(col_name = map(tables, names)) %&gt;%
  select(-tables) %&gt;%
* unnest()
```
]
 
.panel2-define_vars-auto[

```
# A tibble: 20 x 1
   col_name          
   &lt;chr&gt;             
 1 id_rollcall       
 2 session           
 3 ind_importantvote 
 4 dt_vote           
 5 unres             
 6 ind_amendment     
 7 ind_paragraph_vote
 8 short             
 9 descr             
10 ind_issue_me      
11 ind_issue_nu      
12 ind_issue_di      
13 ind_issue_hr      
14 ind_issue_co      
15 ind_issue_ec      
16 id_rollcall       
17 id_country_cow    
18 cat_vote          
19 id_country_code   
20 country           
```
]

---
count: false
 

.panel1-define_vars-auto[

```r
list(tbl_un_roll_calls,
     tbl_un_votes,
     dict_country) %&gt;%
  tibble(tables = .) %&gt;%
  mutate(col_name = map(tables, names)) %&gt;%
  select(-tables) %&gt;%
  unnest() %&gt;%
* distinct()
```
]
 
.panel2-define_vars-auto[

```
# A tibble: 19 x 1
   col_name          
   &lt;chr&gt;             
 1 id_rollcall       
 2 session           
 3 ind_importantvote 
 4 dt_vote           
 5 unres             
 6 ind_amendment     
 7 ind_paragraph_vote
 8 short             
 9 descr             
10 ind_issue_me      
11 ind_issue_nu      
12 ind_issue_di      
13 ind_issue_hr      
14 ind_issue_co      
15 ind_issue_ec      
16 id_country_cow    
17 cat_vote          
18 id_country_code   
19 country           
```
]

---
count: false
 

.panel1-define_vars-auto[

```r
list(tbl_un_roll_calls,
     tbl_un_votes,
     dict_country) %&gt;%
  tibble(tables = .) %&gt;%
  mutate(col_name = map(tables, names)) %&gt;%
  select(-tables) %&gt;%
  unnest() %&gt;%
  distinct() %&gt;%
* arrange(col_name)
```
]
 
.panel2-define_vars-auto[

```
# A tibble: 19 x 1
   col_name          
   &lt;chr&gt;             
 1 cat_vote          
 2 country           
 3 descr             
 4 dt_vote           
 5 id_country_code   
 6 id_country_cow    
 7 id_rollcall       
 8 ind_amendment     
 9 ind_importantvote 
10 ind_issue_co      
11 ind_issue_di      
12 ind_issue_ec      
13 ind_issue_hr      
14 ind_issue_me      
15 ind_issue_nu      
16 ind_paragraph_vote
17 session           
18 short             
19 unres             
```
]

&lt;style&gt;
.panel1-define_vars-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-define_vars-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-define_vars-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---

count: false
 

.panel1-bespoke-auto[

```r
*tribble(~col_name, ~definition,
*"cat_vote", "un vote",
*"country", "country name",
*"definition", "explanation of variable or category",
*"descr", "long form description of resolution from UN",
*"dt_vote", "date of vote",
*"id_country_code", "country code from correlates of war database",
*"id_country_cow", "country code from correlates of war database",
*"id_rollcall", "UN general assembly roll call id number, based on when vote happened",
*"ind_amendment", "indicator variable, whether the vote was on an amendment; coded only until 1985",
*"ind_importantvote", "indicator variable for whether vote was de",
*"issue", "which issue area",
*"ind_paragraph_vote", "Whether the vote was only on a paragraph and not a resolution; coded only until 1985",
*"session", "",
*"short", "Short description from ...",
*"unres", "Resolution code")
```
]
 
.panel2-bespoke-auto[

```
# A tibble: 15 x 2
   col_name         definition                                                  
   &lt;chr&gt;            &lt;chr&gt;                                                       
 1 cat_vote         "un vote"                                                   
 2 country          "country name"                                              
 3 definition       "explanation of variable or category"                       
 4 descr            "long form description of resolution from UN"               
 5 dt_vote          "date of vote"                                              
 6 id_country_code  "country code from correlates of war database"              
 7 id_country_cow   "country code from correlates of war database"              
 8 id_rollcall      "UN general assembly roll call id number, based on when vot…
 9 ind_amendment    "indicator variable, whether the vote was on an amendment; …
10 ind_importantvo… "indicator variable for whether vote was de"                
11 issue            "which issue area"                                          
12 ind_paragraph_v… "Whether the vote was only on a paragraph and not a resolut…
13 session          ""                                                          
14 short            "Short description from ..."                                
15 unres            "Resolution code"                                           
```
]

---
count: false
 

.panel1-bespoke-auto[

```r
tribble(~col_name, ~definition,
"cat_vote", "un vote",
"country", "country name",
"definition", "explanation of variable or category",
"descr", "long form description of resolution from UN",
"dt_vote", "date of vote",
"id_country_code", "country code from correlates of war database",
"id_country_cow", "country code from correlates of war database",
"id_rollcall", "UN general assembly roll call id number, based on when vote happened",
"ind_amendment", "indicator variable, whether the vote was on an amendment; coded only until 1985",
"ind_importantvote", "indicator variable for whether vote was de",
"issue", "which issue area",
"ind_paragraph_vote", "Whether the vote was only on a paragraph and not a resolution; coded only until 1985",
"session", "",
"short", "Short description from ...",
"unres", "Resolution code") %&gt;%
* bind_rows(col_definitions_roll_call_issues)
```
]
 
.panel2-bespoke-auto[

```
# A tibble: 21 x 2
   col_name        definition                                                   
   &lt;chr&gt;           &lt;chr&gt;                                                        
 1 cat_vote        un vote                                                      
 2 country         country name                                                 
 3 definition      explanation of variable or category                          
 4 descr           long form description of resolution from UN                  
 5 dt_vote         date of vote                                                 
 6 id_country_code country code from correlates of war database                 
 7 id_country_cow  country code from correlates of war database                 
 8 id_rollcall     UN general assembly roll call id number, based on when vote …
 9 ind_amendment   indicator variable, whether the vote was on an amendment; co…
10 ind_importantv… indicator variable for whether vote was de                   
# … with 11 more rows
```
]

---
count: false
 

.panel1-bespoke-auto[

```r
tribble(~col_name, ~definition,
"cat_vote", "un vote",
"country", "country name",
"definition", "explanation of variable or category",
"descr", "long form description of resolution from UN",
"dt_vote", "date of vote",
"id_country_code", "country code from correlates of war database",
"id_country_cow", "country code from correlates of war database",
"id_rollcall", "UN general assembly roll call id number, based on when vote happened",
"ind_amendment", "indicator variable, whether the vote was on an amendment; coded only until 1985",
"ind_importantvote", "indicator variable for whether vote was de",
"issue", "which issue area",
"ind_paragraph_vote", "Whether the vote was only on a paragraph and not a resolution; coded only until 1985",
"session", "",
"short", "Short description from ...",
"unres", "Resolution code") %&gt;%
  bind_rows(col_definitions_roll_call_issues) %&gt;%
* arrange(col_name)
```
]
 
.panel2-bespoke-auto[

```
# A tibble: 21 x 2
   col_name        definition                                                   
   &lt;chr&gt;           &lt;chr&gt;                                                        
 1 cat_vote        un vote                                                      
 2 country         country name                                                 
 3 definition      explanation of variable or category                          
 4 descr           long form description of resolution from UN                  
 5 dt_vote         date of vote                                                 
 6 id_country_code country code from correlates of war database                 
 7 id_country_cow  country code from correlates of war database                 
 8 id_rollcall     UN general assembly roll call id number, based on when vote …
 9 ind_amendment   indicator variable, whether the vote was on an amendment; co…
10 ind_importantv… indicator variable for whether vote was de                   
# … with 11 more rows
```
]

---
count: false
 

.panel1-bespoke-auto[

```r
tribble(~col_name, ~definition,
"cat_vote", "un vote",
"country", "country name",
"definition", "explanation of variable or category",
"descr", "long form description of resolution from UN",
"dt_vote", "date of vote",
"id_country_code", "country code from correlates of war database",
"id_country_cow", "country code from correlates of war database",
"id_rollcall", "UN general assembly roll call id number, based on when vote happened",
"ind_amendment", "indicator variable, whether the vote was on an amendment; coded only until 1985",
"ind_importantvote", "indicator variable for whether vote was de",
"issue", "which issue area",
"ind_paragraph_vote", "Whether the vote was only on a paragraph and not a resolution; coded only until 1985",
"session", "",
"short", "Short description from ...",
"unres", "Resolution code") %&gt;%
  bind_rows(col_definitions_roll_call_issues) %&gt;%
  arrange(col_name) -&gt;
*variable_definitions
```
]
 
.panel2-bespoke-auto[

]

&lt;style&gt;
.panel1-bespoke-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-bespoke-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-bespoke-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---


```r
tribble(~table, ~definition,
"tbl_un_roll_calls", "a table of information about each roll call vote, including the date, description, and relevant resolution that was voted on, whether topic was one of six issues",
"tbl_un_votes", "table with the history of each country’s vote, one row for each country/vote pair"
) -&gt;
  provenance_tables
```

---

# Put it all together...

---

count: false
 

.panel1-together-auto[

```r
*library(DBI)
```
]
 
.panel2-together-auto[

]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

*con &lt;- dbConnect(RSQLite::SQLite(),
*                dbname = ":memory:")
```
]
 
.panel2-together-auto[

]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

*dbListTables(con)
```
]
 
.panel2-together-auto[

```
character(0)
```
]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

dbListTables(con)

*dbWriteTable(con, "tbl_un_roll_calls", tbl_un_roll_calls)
```
]
 
.panel2-together-auto[

```
character(0)
```
]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

dbListTables(con)

dbWriteTable(con, "tbl_un_roll_calls", tbl_un_roll_calls)
*dbWriteTable(con, "tbl_un_votes", tbl_un_votes)
```
]
 
.panel2-together-auto[

```
character(0)
```
]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

dbListTables(con)

dbWriteTable(con, "tbl_un_roll_calls", tbl_un_roll_calls)
dbWriteTable(con, "tbl_un_votes", tbl_un_votes)
*dbWriteTable(con, "dict_country", dict_country)
```
]
 
.panel2-together-auto[

```
character(0)
```
]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

dbListTables(con)

dbWriteTable(con, "tbl_un_roll_calls", tbl_un_roll_calls)
dbWriteTable(con, "tbl_un_votes", tbl_un_votes)
dbWriteTable(con, "dict_country", dict_country)
*dbWriteTable(con, "variable_definitions", variable_definitions)
```
]
 
.panel2-together-auto[

```
character(0)
```
]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

dbListTables(con)

dbWriteTable(con, "tbl_un_roll_calls", tbl_un_roll_calls)
dbWriteTable(con, "tbl_un_votes", tbl_un_votes)
dbWriteTable(con, "dict_country", dict_country)
dbWriteTable(con, "variable_definitions", variable_definitions)
*dbWriteTable(con, "provenance_tables", provenance_tables)
```
]
 
.panel2-together-auto[

```
character(0)
```
]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

dbListTables(con)

dbWriteTable(con, "tbl_un_roll_calls", tbl_un_roll_calls)
dbWriteTable(con, "tbl_un_votes", tbl_un_votes)
dbWriteTable(con, "dict_country", dict_country)
dbWriteTable(con, "variable_definitions", variable_definitions)
dbWriteTable(con, "provenance_tables", provenance_tables)

*dbListTables(con)
```
]
 
.panel2-together-auto[

```
character(0)
```

```
[1] "dict_country"         "provenance_tables"    "tbl_un_roll_calls"   
[4] "tbl_un_votes"         "variable_definitions"
```
]

---
count: false
 

.panel1-together-auto[

```r
library(DBI)

con &lt;- dbConnect(RSQLite::SQLite(),
                 dbname = ":memory:")

dbListTables(con)

dbWriteTable(con, "tbl_un_roll_calls", tbl_un_roll_calls)
dbWriteTable(con, "tbl_un_votes", tbl_un_votes)
dbWriteTable(con, "dict_country", dict_country)
dbWriteTable(con, "variable_definitions", variable_definitions)
dbWriteTable(con, "provenance_tables", provenance_tables)

dbListTables(con)
```
]
 
.panel2-together-auto[

```
character(0)
```

```
[1] "dict_country"         "provenance_tables"    "tbl_un_roll_calls"   
[4] "tbl_un_votes"         "variable_definitions"
```
]

&lt;style&gt;
.panel1-together-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-together-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-together-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---


```r
res &lt;- dbSendQuery(con, 
                   "SELECT * FROM tbl_un_votes WHERE id_rollcall = 3")
dbFetch(res)
```

```
   id_rollcall id_country_cow cat_vote
1            3             US      yes
2            3             CA       no
3            3             CU      yes
4            3             HT      yes
5            3             DO      yes
6            3             MX      yes
7            3             GT      yes
8            3             HN      yes
9            3             SV      yes
10           3             NI      yes
11           3             CR      yes
12           3             PA      yes
13           3             CO      yes
14           3             VE      yes
15           3             EC      yes
16           3             PE      yes
17           3             BR      yes
18           3             BO      yes
19           3             PY      yes
20           3             CL      yes
21           3             AR      yes
22           3             UY      yes
23           3             GB       no
24           3             NL       no
25           3             BE      yes
26           3             LU       no
27           3             FR       no
28           3             PL      yes
29           3             CS      yes
30           3             YU       no
31           3             GR       no
32           3             RU       no
33           3             UA       no
34           3             BY       no
35           3             NO       no
36           3             DK       no
37           3             LR       no
38           3             ET      yes
39           3             ZA       no
40           3             IR      yes
41           3             TR      yes
42           3             IQ  abstain
43           3             EG  abstain
44           3             SY      yes
45           3             LB  abstain
46           3             SA  abstain
47           3             TW       no
48           3             IN       no
49           3             PH      yes
50           3             AU       no
51           3             NZ       no
```




---


count: false
 
## dplyr type manipulation
.panel1-test-auto[

```r
*tbl(con, "tbl_un_votes")
```
]
 
.panel2-test-auto[

```
# Source:   table&lt;tbl_un_votes&gt; [?? x 3]
# Database: sqlite 3.30.1 [:memory:]
   id_rollcall id_country_cow cat_vote
         &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;   
 1           3 US             yes     
 2           3 CA             no      
 3           3 CU             yes     
 4           3 HT             yes     
 5           3 DO             yes     
 6           3 MX             yes     
 7           3 GT             yes     
 8           3 HN             yes     
 9           3 SV             yes     
10           3 NI             yes     
# … with more rows
```
]

---
count: false
 
## dplyr type manipulation
.panel1-test-auto[

```r
tbl(con, "tbl_un_votes")  %&gt;%
* group_by(id_country_cow)
```
]
 
.panel2-test-auto[

```
# Source:   table&lt;tbl_un_votes&gt; [?? x 3]
# Database: sqlite 3.30.1 [:memory:]
# Groups:   id_country_cow
   id_rollcall id_country_cow cat_vote
         &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;   
 1           3 US             yes     
 2           3 CA             no      
 3           3 CU             yes     
 4           3 HT             yes     
 5           3 DO             yes     
 6           3 MX             yes     
 7           3 GT             yes     
 8           3 HN             yes     
 9           3 SV             yes     
10           3 NI             yes     
# … with more rows
```
]

---
count: false
 
## dplyr type manipulation
.panel1-test-auto[

```r
tbl(con, "tbl_un_votes")  %&gt;%
  group_by(id_country_cow) %&gt;%
* mutate(ind_vote_yes = cat_vote == "yes")
```
]
 
.panel2-test-auto[

```
# Source:   lazy query [?? x 4]
# Database: sqlite 3.30.1 [:memory:]
# Groups:   id_country_cow
   id_rollcall id_country_cow cat_vote ind_vote_yes
         &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;           &lt;int&gt;
 1           3 US             yes                 1
 2           3 CA             no                  0
 3           3 CU             yes                 1
 4           3 HT             yes                 1
 5           3 DO             yes                 1
 6           3 MX             yes                 1
 7           3 GT             yes                 1
 8           3 HN             yes                 1
 9           3 SV             yes                 1
10           3 NI             yes                 1
# … with more rows
```
]

---
count: false
 
## dplyr type manipulation
.panel1-test-auto[

```r
tbl(con, "tbl_un_votes")  %&gt;%
  group_by(id_country_cow) %&gt;%
  mutate(ind_vote_yes = cat_vote == "yes") %&gt;%
* summarise(prop_yes = mean(ind_vote_yes))
```
]
 
.panel2-test-auto[

```
# Source:   lazy query [?? x 2]
# Database: sqlite 3.30.1 [:memory:]
   id_country_cow prop_yes
   &lt;chr&gt;             &lt;dbl&gt;
 1 &lt;NA&gt;              0.659
 2 AD                0.645
 3 AE                0.941
 4 AF                0.842
 5 AG                0.919
 6 AL                0.716
 7 AM                0.759
 8 AO                0.922
 9 AR                0.779
10 AT                0.633
# … with more rows
```
]

---
count: false
 
## dplyr type manipulation
.panel1-test-auto[

```r
tbl(con, "tbl_un_votes")  %&gt;%
  group_by(id_country_cow) %&gt;%
  mutate(ind_vote_yes = cat_vote == "yes") %&gt;%
  summarise(prop_yes = mean(ind_vote_yes)) %&gt;%
* filter(prop_yes &gt; .7)
```
]
 
.panel2-test-auto[

```
# Source:   lazy query [?? x 2]
# Database: sqlite 3.30.1 [:memory:]
   id_country_cow prop_yes
   &lt;chr&gt;             &lt;dbl&gt;
 1 AE                0.941
 2 AF                0.842
 3 AG                0.919
 4 AL                0.716
 5 AM                0.759
 6 AO                0.922
 7 AR                0.779
 8 AZ                0.868
 9 BB                0.909
10 BD                0.938
# … with more rows
```
]

---
count: false
 
## dplyr type manipulation
.panel1-test-auto[

```r
tbl(con, "tbl_un_votes")  %&gt;%
  group_by(id_country_cow) %&gt;%
  mutate(ind_vote_yes = cat_vote == "yes") %&gt;%
  summarise(prop_yes = mean(ind_vote_yes)) %&gt;%
  filter(prop_yes &gt; .7) %&gt;%
* collect()
```
]
 
.panel2-test-auto[

```
# A tibble: 145 x 2
   id_country_cow prop_yes
   &lt;chr&gt;             &lt;dbl&gt;
 1 AE                0.941
 2 AF                0.842
 3 AG                0.919
 4 AL                0.716
 5 AM                0.759
 6 AO                0.922
 7 AR                0.779
 8 AZ                0.868
 9 BB                0.909
10 BD                0.938
# … with 135 more rows
```
]

&lt;style&gt;
.panel1-test-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-test-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-test-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;







---


count: false
 
## translation to underlying sql syntax
.panel1-query_translation-auto[

```r
*q1 &lt;- tbl(con, "tbl_un_votes")

q1  %&gt;%
show_query()
```
]
 
.panel2-query_translation-auto[

```
&lt;SQL&gt;
SELECT *
FROM `tbl_un_votes`
```
]

---
count: false
 
## translation to underlying sql syntax
.panel1-query_translation-auto[

```r
q1 &lt;- tbl(con, "tbl_un_votes") %&gt;%
* group_by(id_country_cow)

q1  %&gt;%
show_query()
```
]
 
.panel2-query_translation-auto[

```
&lt;SQL&gt;
SELECT *
FROM `tbl_un_votes`
```
]

---
count: false
 
## translation to underlying sql syntax
.panel1-query_translation-auto[

```r
q1 &lt;- tbl(con, "tbl_un_votes") %&gt;%
  group_by(id_country_cow) %&gt;%
* mutate(ind_vote_yes = cat_vote == "yes")

q1  %&gt;%
show_query()
```
]
 
.panel2-query_translation-auto[

```
&lt;SQL&gt;
SELECT `id_rollcall`, `id_country_cow`, `cat_vote`, `cat_vote` = 'yes' AS `ind_vote_yes`
FROM `tbl_un_votes`
```
]

---
count: false
 
## translation to underlying sql syntax
.panel1-query_translation-auto[

```r
q1 &lt;- tbl(con, "tbl_un_votes") %&gt;%
  group_by(id_country_cow) %&gt;%
  mutate(ind_vote_yes = cat_vote == "yes") %&gt;%
* summarise(prop_yes = mean(ind_vote_yes))

q1  %&gt;%
show_query()
```
]
 
.panel2-query_translation-auto[

```
&lt;SQL&gt;
SELECT `id_country_cow`, AVG(`ind_vote_yes`) AS `prop_yes`
FROM (SELECT `id_rollcall`, `id_country_cow`, `cat_vote`, `cat_vote` = 'yes' AS `ind_vote_yes`
FROM `tbl_un_votes`)
GROUP BY `id_country_cow`
```
]

---
count: false
 
## translation to underlying sql syntax
.panel1-query_translation-auto[

```r
q1 &lt;- tbl(con, "tbl_un_votes") %&gt;%
  group_by(id_country_cow) %&gt;%
  mutate(ind_vote_yes = cat_vote == "yes") %&gt;%
  summarise(prop_yes = mean(ind_vote_yes)) %&gt;%
* filter(prop_yes &gt; .7)

q1  %&gt;%
show_query()
```
]
 
.panel2-query_translation-auto[

```
&lt;SQL&gt;
SELECT *
FROM (SELECT `id_country_cow`, AVG(`ind_vote_yes`) AS `prop_yes`
FROM (SELECT `id_rollcall`, `id_country_cow`, `cat_vote`, `cat_vote` = 'yes' AS `ind_vote_yes`
FROM `tbl_un_votes`)
GROUP BY `id_country_cow`)
WHERE (`prop_yes` &gt; 0.7)
```
]

---
count: false
 
## translation to underlying sql syntax
.panel1-query_translation-auto[

```r
q1 &lt;- tbl(con, "tbl_un_votes") %&gt;%
  group_by(id_country_cow) %&gt;%
  mutate(ind_vote_yes = cat_vote == "yes") %&gt;%
  summarise(prop_yes = mean(ind_vote_yes)) %&gt;%
  filter(prop_yes &gt; .7) %&gt;%
* arrange(-prop_yes)

q1  %&gt;%
show_query()
```
]
 
.panel2-query_translation-auto[

```
&lt;SQL&gt;
SELECT *
FROM (SELECT `id_country_cow`, AVG(`ind_vote_yes`) AS `prop_yes`
FROM (SELECT `id_rollcall`, `id_country_cow`, `cat_vote`, `cat_vote` = 'yes' AS `ind_vote_yes`
FROM `tbl_un_votes`)
GROUP BY `id_country_cow`)
WHERE (`prop_yes` &gt; 0.7)
ORDER BY -`prop_yes`
```
]

&lt;style&gt;
.panel1-query_translation-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-query_translation-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-query_translation-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;









---



```r
library(DBI)
library(dplyr)
library(dbplyr)
library(odbc)
con &lt;- dbConnect(odbc::odbc(), "Oracle DB")
```


```sql
SELECT "month_idx", "year", "month", SUM(CASE WHEN ("term_deposit" = 'yes') THEN (1.0) ELSE (0.0) END) AS "subscribe",
COUNT(*) AS "total"
FROM ("bank") 
GROUP BY "month_idx", "year", "month"
```







---


&lt;style type="text/css"&gt;
.remark-code{line-height: 1.5; font-size: 65%}

@media print {
  .has-continuation {
    display: block;
  }
}
&lt;/style&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:10",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
